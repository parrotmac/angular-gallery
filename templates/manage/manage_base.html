{% load staticfiles %}
<!DOCTYPE HTML>
<html>
    <head>
        <title>Management Suite | {% block page_title %}Main{% endblock %}</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes">
        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">
{#        <link rel="stylesheet" href="{% static "style.css" %}">#}
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.js"></script>
        <script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
{#        <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.3.0-beta.8/angular.min.js"></script>#}
        {% block head_area %}{% endblock %}
    </head>
    <body>
    <div class="container">
        <div class="row">
            <div class="col-sm-1"></div>
            <div class="col-sm-10">
                <h1>Welcome, {{ user|capfirst }}</h1>
                <a href="{% url "manage_home" %}">Manage</a>
                <br>
                <br>
                <form action="{% url 'login' %}?next={{ request.path }}" method="POST">
                    {% csrf_token %}
                    <button name="logout" class="btn btn-default">Logout</button>
                </form>
            </div>
            <div class="col-sm-1"></div>
        </div>
        <div class="row">
            <div class="col-sm-1"></div>
            <div class="col-sm-10">
                {% block content %}
                    <h1>Things to manage...</h1>
                    <hr />
                    <h3>Management Actions</h3>
                    <ul style="list-style: none">
                        <li><a href="{% url "manage_gallery" %}">Galleries</a></li>
                        <li><a href="{% url "manage_gallery_cover" %}">Gallery Covers</a></li>
                        <li><a href="{% url "manage_photos" %}">Individual Photos</a></li>
                        <li><a href="{% url "manage_clients" %}">Clients</a></li>
                    </ul>
                    <hr />
                    <h3>Quick Links</h3>
                    <ul style="list-style: none">
                        <li><a href="{% url 'manage_upload' %}">Upload</a></li>
                        <li><a href="{% url 'manage_feature_upload' %}">Set Features</a></li>
                    </ul>
                {% endblock %}
            </div>
            <div class="col-sm-1"></div>
        </div>
    </div>

    <div class="modal" tabindex="-1" id="messageModal">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <h1 style="text-align: center; margin: 10px;" class="message-modal-header"></h1>
                <span style="text-align: center; font-size: 200px; display: block; margin: 30px auto;" class="glyphicon glyphicon-refresh spin"></span>
            </div>
        </div>
    </div>

   <div class="modal fade" tabindex="-1" id="errorMessageModal">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <h3 style="text-align: center; margin: 10px;" class="error-message-modal-header"></h3>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Okay</button>
                </div>
            </div>
        </div>
    </div>


    <script>

    //The necessary evil
    function getCookie(name) {
        var cookieValue = null;
        if (document.cookie && document.cookie != '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = jQuery.trim(cookies[i]);
                // Does this cookie string begin with the name we want?
                if (cookie.substring(0, name.length + 1) == (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
    var csrftoken = getCookie('csrftoken');

    function galleryActiveToggle(sender) {
        var galleryToToggle = sender.value;
        console.log("Gallery " + galleryToToggle + " is now:" + (sender.checked?"active":"inactive"));
        $.ajax({
            type: "POST",
            url: "{% url 'manage_gallery' %}",
            data: {csrfmiddlewaretoken: csrftoken, toggle_active: galleryToToggle, active_state: sender.checked}
        }).done(function(data) {
            console.log(data);
            console.log(JSON.parse(data));
        })
    }

    function showUserProgressMessage(showMessage, message) {
        if(showMessage) {
            $(".message-modal-header").text(message)
            $('#messageModal').modal('show');
        } else {
            $('#messageModal').delay(500).modal('hide');
        }
    }
    function showUserErrorMessage(message) {
        $(".error-message-modal-header").text(message);
        $("#errorMessageModal").modal('show');
    }
    </script>
        {% block put_script_tags_here %}
        <script></script>
        {% endblock %}
    </body>
</html>